<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - @rasenok Only</title>
    <style>
        /* ========== RESET & BASE ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        /* ========== ADMIN CONTAINER ========== */
        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            min-height: 90vh;
        }
        
        /* ========== HEADER ========== */
        .admin-header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 25px 30px;
            position: relative;
            overflow: hidden;
        }
        
        .admin-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200px;
            height: 200px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .admin-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .admin-icon {
            font-size: 2.5rem;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }
        
        .admin-badge {
            background: #00c853;
            color: white;
            padding: 8px 20px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 0.9rem;
            box-shadow: 0 4px 15px rgba(0,200,83,0.3);
        }
        
        .header-subtitle {
            color: rgba(255,255,255,0.8);
            font-size: 0.95rem;
            margin-top: 5px;
        }
        
        /* ========== STATS DASHBOARD ========== */
        .stats-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }
        
        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border-left: 5px solid #667eea;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .stat-card.players { border-left-color: #00c853; }
        .stat-card.pending { border-left-color: #ff9800; }
        .stat-card.deposits { border-left-color: #2196f3; }
        .stat-card.winnings { border-left-color: #9c27b0; }
        
        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .stat-icon {
            font-size: 2.2rem;
            opacity: 0.3;
        }
        
        .stat-badge {
            background: #ff5252;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .stat-title {
            color: #666;
            font-size: 0.95rem;
            font-weight: 500;
            margin-bottom: 8px;
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .stat-change {
            color: #666;
            font-size: 0.85rem;
        }
        
        /* ========== CONTENT SECTIONS ========== */
        .admin-content {
            padding: 30px;
        }
        
        .section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
            border: 1px solid #eef2f7;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f4f8;
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 12px;
            color: #2c3e50;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .section-icon {
            font-size: 1.5rem;
        }
        
        .section-actions {
            display: flex;
            gap: 10px;
        }
        
        /* ========== BUTTONS ========== */
        .btn {
            padding: 12px 25px;
            border-radius: 10px;
            border: none;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #00c853, #64dd17);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ff5252, #ff4081);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ff9800, #ffb74d);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .btn-sm {
            padding: 8px 15px;
            font-size: 0.85rem;
        }
        
        /* ========== FORMS ========== */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: 500;
            font-size: 0.95rem;
        }
        
        .form-input {
            width: 100%;
            padding: 14px;
            border: 2px solid #e1e5eb;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
            background: #f8fafc;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        /* ========== TABLES & LISTS ========== */
        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            border: 1px solid #e1e5eb;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }
        
        .data-table th {
            background: #f8fafc;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #2c3e50;
            border-bottom: 2px solid #e1e5eb;
        }
        
        .data-table td {
            padding: 15px;
            border-bottom: 1px solid #eef2f7;
            color: #4a5568;
        }
        
        .data-table tr:hover {
            background: #f8fafc;
        }
        
        /* ========== CARDS ========== */
        .player-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border: 2px solid #eef2f7;
            transition: all 0.3s;
        }
        
        .player-card:hover {
            border-color: #667eea;
            transform: translateX(5px);
        }
        
        .player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .player-name {
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.1rem;
        }
        
        .player-balance {
            background: linear-gradient(135deg, #00c853, #64dd17);
            color: white;
            padding: 6px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .player-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            color: #666;
            font-size: 0.9rem;
        }
        
        /* ========== PENDING REQUESTS ========== */
        .pending-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .pending-card {
            background: #fff8e1;
            border: 2px solid #ffd54f;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            animation: glow 2s infinite alternate;
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 10px rgba(255, 213, 79, 0.3); }
            to { box-shadow: 0 0 20px rgba(255, 213, 79, 0.6); }
        }
        
        .pending-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .pending-amount {
            font-size: 1.5rem;
            font-weight: 700;
            color: #ff6f00;
        }
        
        .pending-actions {
            display: flex;
            gap: 10px;
        }
        
        /* ========== DANGER ZONE ========== */
        .danger-zone {
            border: 2px solid #ff5252;
            background: #fff5f5;
        }
        
        .danger-header {
            color: #ff5252 !important;
        }
        
        .danger-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        /* ========== FOOTER ========== */
        .admin-footer {
            background: #f8fafc;
            padding: 20px 30px;
            border-top: 1px solid #e1e5eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #666;
        }
        
        .session-info {
            display: flex;
            gap: 20px;
        }
        
        /* ========== UTILITIES ========== */
        .badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .badge-success { background: #c8e6c9; color: #2e7d32; }
        .badge-warning { background: #fff0c2; color: #ff8f00; }
        .badge-danger { background: #ffcdd2; color: #c62828; }
        
        .status-dot {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-active { background: #00c853; }
        .status-pending { background: #ff9800; }
        .status-inactive { background: #9e9e9e; }
        
        /* ========== LOADING ========== */
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ========== RESPONSIVE ========== */
        @media (max-width: 768px) {
            .admin-container {
                border-radius: 10px;
            }
            
            .stats-dashboard {
                grid-template-columns: 1fr;
                padding: 20px;
            }
            
            .section {
                padding: 20px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .header-top {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .admin-footer {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- ADMIN CONTAINER -->
    <div class="admin-container">
        <!-- HEADER -->
        <header class="admin-header">
            <div class="header-top">
                <div class="admin-title">
                    <span class="admin-icon">üîß</span>
                    <div>
                        <h1 style="margin: 0; font-size: 1.8rem;">Admin Control Panel</h1>
                        <p class="header-subtitle">Welcome, <strong>@rasenok</strong> ‚Ä¢ Full System Access</p>
                    </div>
                </div>
                <div class="admin-badge">
                    ‚ö° SUPER ADMIN
                </div>
            </div>
        </header>
        
        <!-- STATS DASHBOARD -->
        <div class="stats-dashboard">
            <div class="stat-card players">
                <div class="stat-header">
                    <span class="stat-icon">üë•</span>
                    <span class="stat-badge" id="pendingBadge">!</span>
                </div>
                <div class="stat-title">TOTAL PLAYERS</div>
                <div class="stat-value" id="totalPlayers">127</div>
                <div class="stat-change">+12 today</div>
            </div>
            
            <div class="stat-card pending">
                <div class="stat-header">
                    <span class="stat-icon">‚è≥</span>
                </div>
                <div class="stat-title">PENDING REQUESTS</div>
                <div class="stat-value" id="pendingCount">8</div>
                <div class="stat-change">Waiting approval</div>
            </div>
            
            <div class="stat-card deposits">
                <div class="stat-header">
                    <span class="stat-icon">üí∞</span>
                </div>
                <div class="stat-title">TOTAL DEPOSITS</div>
                <div class="stat-value" id="totalDeposits">15,240 ETB</div>
                <div class="stat-change">+2,400 ETB today</div>
            </div>
            
            <div class="stat-card winnings">
                <div class="stat-header">
                    <span class="stat-icon">üèÜ</span>
                </div>
                <div class="stat-title">TOTAL WINNINGS</div>
                <div class="stat-value" id="totalWinnings">8,560 ETB</div>
                <div class="stat-change">Paid to players</div>
            </div>
        </div>
        
        <!-- MAIN CONTENT -->
        <div class="admin-content">
            <!-- PLAYER MANAGEMENT -->
            <section class="section">
                <div class="section-header">
                    <h2 class="section-title">
                        <span class="section-icon">üë§</span>
                        Player Management
                    </h2>
                    <div class="section-actions">
                        <button class="btn btn-primary btn-sm">
                            <span>üîÑ</span> Refresh
                        </button>
                        <button class="btn btn-success btn-sm">
                            <span>‚ûï</span> Add Player
                        </button>
                    </div>
                </div>
                
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="üîç Search players by name, phone, or ID...">
                </div>
                
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Player</th>
                                <th>Phone</th>
                                <th>Balance</th>
                                <th>Status</th>
                                <th>Last Active</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <strong>John Doe</strong>
                                    <div style="font-size: 0.85rem; color: #666;">ID: P001</div>
                                </td>
                                <td>0912345678</td>
                                <td>
                                    <span class="player-balance">1,250 ETB</span>
                                </td>
                                <td>
                                    <span class="badge badge-success">
                                        <span class="status-dot status-active"></span>
                                        Active
                                    </span>
                                </td>
                                <td>2 hours ago</td>
                                <td>
                                    <button class="btn btn-primary btn-sm">Edit</button>
                                    <button class="btn btn-warning btn-sm">History</button>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Jane Smith</strong>
                                    <div style="font-size: 0.85rem; color: #666;">ID: P002</div>
                                </td>
                                <td>0923456789</td>
                                <td>
                                    <span class="player-balance">580 ETB</span>
                                </td>
                                <td>
                                    <span class="badge badge-warning">
                                        <span class="status-dot status-pending"></span>
                                        Pending
                                    </span>
                                </td>
                                <td>1 day ago</td>
                                <td>
                                    <button class="btn btn-primary btn-sm">Edit</button>
                                    <button class="btn btn-warning btn-sm">History</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- PENDING REQUESTS -->
            <section class="section">
                <div class="section-header">
                    <h2 class="section-title">
                        <span class="section-icon">‚è≥</span>
                        Pending Deposit Requests
                    </h2>
                    <div class="badge badge-warning">8 Pending</div>
                </div>
                
                <div class="pending-list">
                    <div class="pending-card">
                        <div class="pending-header">
                            <div>
                                <h3 style="margin: 0 0 5px 0;">Michael Johnson</h3>
                                <p style="margin: 0; color: #666;">0912345678</p>
                            </div>
                            <div class="pending-amount">500 ETB</div>
                        </div>
                        <p style="color: #666; margin-bottom: 15px;">Requested: 2 hours ago</p>
                        <div class="pending-actions">
                            <button class="btn btn-success">‚úÖ Approve</button>
                            <button class="btn btn-danger">‚ùå Reject</button>
                            <button class="btn btn-primary">üìû Contact</button>
                        </div>
                    </div>
                    
                    <div class="pending-card">
                        <div class="pending-header">
                            <div>
                                <h3 style="margin: 0 0 5px 0;">Sarah Williams</h3>
                                <p style="margin: 0; color: #666;">0923456789</p>
                            </div>
                            <div class="pending-amount">1,000 ETB</div>
                        </div>
                        <p style="color: #666; margin-bottom: 15px;">Requested: 1 hour ago</p>
                        <div class="pending-actions">
                            <button class="btn btn-success">‚úÖ Approve</button>
                            <button class="btn btn-danger">‚ùå Reject</button>
                            <button class="btn btn-primary">üìû Contact</button>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- BALANCE MANAGEMENT -->
            <section class="section">
                <div class="section-header">
                    <h2 class="section-title">
                        <span class="section-icon">üíµ</span>
                        Manual Balance Management
                    </h2>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Select Player</label>
                        <select class="form-input">
                            <option>Select player...</option>
                            <option>John Doe (0912345678)</option>
                            <option>Jane Smith (0923456789)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Current Balance</label>
                        <input type="text" class="form-input" value="1,250 ETB" readonly>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Amount (ETB)</label>
                        <input type="number" class="form-input" placeholder="Enter amount">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Transaction Type</label>
                        <select class="form-input">
                            <option>Add Balance (+)</option>
                            <option>Remove Balance (-)</option>
                            <option>Bonus</option>
                            <option>Penalty</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Reason/Notes</label>
                    <textarea class="form-input" rows="3" placeholder="Optional reason for this transaction..."></textarea>
                </div>
                
                <div style="display: flex; gap: 15px; margin-top: 20px;">
                    <button class="btn btn-success">
                        <span>‚ûï</span> Add Balance
                    </button>
                    <button class="btn btn-danger">
                        <span>‚ûñ</span> Remove Balance
                    </button>
                    <button class="btn btn-primary">
                        <span>üíæ</span> Save Transaction
                    </button>
                </div>
            </section>
            
            <!-- DANGER ZONE -->
            <section class="section danger-zone">
                <div class="section-header">
                    <h2 class="section-title danger-header">
                        <span class="section-icon">‚ö†Ô∏è</span>
                        Danger Zone
                    </h2>
                    <div class="badge badge-danger">ADMIN ONLY</div>
                </div>
                
                <p style="color: #c62828; margin-bottom: 20px;">
                    <strong>Warning:</strong> These actions are irreversible and will affect all system data.
                    Proceed with extreme caution.
                </p>
                
                <div class="danger-actions">
                    <button class="btn btn-danger">
                        <span>üîÑ</span> Reset All Data
                    </button>
                    <button class="btn btn-danger">
                        <span>üì•</span> Export Database
                    </button>
                    <button class="btn btn-danger">
                        <span>üóëÔ∏è</span> Clear All Pending
                    </button>
                    <button class="btn btn-danger">
                        <span>üßπ</span> Purge Inactive Users
                    </button>
                </div>
                
                <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid #ffcdd2;">
                    <p style="color: #666; margin-bottom: 10px;">
                        <strong>System Status:</strong> All services operational
                    </p>
                    <button class="btn btn-primary">
                        <span>üìä</span> Generate System Report
                    </button>
                </div>
            </section>
        </div>
        
        <!-- FOOTER -->
        <footer class="admin-footer">
            <div class="session-info">
                <span>üõ°Ô∏è Session: <strong>@rasenok</strong></span>
                <span>üïê Duration: <strong id="sessionTimer">00:05:32</strong></span>
                <span>üìù Actions: <strong>24</strong> today</span>
            </div>
            <div>
                <button class="btn btn-primary btn-sm">
                    <span>üìã</span> Audit Log
                </button>
                <button class="btn btn-danger btn-sm">
                    <span>üö™</span> Logout
                </button>
            </div>
        </footer>
    </div>

    <script>
        // ==================== ADMIN SYSTEM ====================

        // Admin configuration
        const ADMIN_CONFIG = {
            username: 'rasenok',
            password: 'admin123',
            sessionTimeout: 60 // minutes
        };

        // Check if current user is admin
        function isAdminUser() {
            try {
                const tg = window.Telegram?.WebApp;
                if (tg && tg.initDataUnsafe?.user?.username) {
                    return tg.initDataUnsafe.user.username === ADMIN_CONFIG.username;
                }
            } catch (e) {
                console.log("Telegram not available, checking localStorage");
            }
            
            // For testing: Check localStorage for emergency access
            return localStorage.getItem('adminEmergencyAccess') === 'true';
        }

        // Initialize admin access
        function initAdminAccess() {
            console.log("Initializing admin access...");
            
            const adminButtonContainer = document.getElementById('adminButtonContainer');
            const adminAccessSection = document.getElementById('adminAccessSection');
            const emergencyAccess = document.getElementById('adminEmergencyAccess');
            
            if (!adminButtonContainer || !adminAccessSection) {
                console.error("Admin elements not found!");
                return;
            }
            
            if (isAdminUser()) {
                console.log("User is admin (@rasenok), showing admin button");
                
                // Show admin button
                adminButtonContainer.innerHTML = `
                    <button class="btn" style="background: linear-gradient(135deg, #8a2be2, #6f42c1); color: white; padding: 12px; width: 100%; border-radius: 10px; font-size: 1rem; font-weight: bold; cursor: pointer;" onclick="showAdminPage()">
                        üîß Admin Panel
                    </button>
                `;
                
                // Show emergency access for testing
                if (emergencyAccess) {
                    emergencyAccess.style.display = 'block';
                }
                
            } else {
                console.log("User is not admin, hiding admin section");
                adminAccessSection.style.display = 'none';
            }
        }

        // Show admin page
        function showAdminPage() {
            console.log("Showing admin page...");
            
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.style.display = 'none';
            });
            
            // Show admin page
            const adminPage = document.getElementById('adminPage');
            if (adminPage) {
                adminPage.style.display = 'block';
                
                // Show login form by default
                const loginForm = document.getElementById('adminLoginForm');
                const adminContent = document.getElementById('adminContent');
                
                if (loginForm) loginForm.style.display = 'block';
                if (adminContent) adminContent.style.display = 'none';
                
                // Check if already logged in
                if (localStorage.getItem('adminLoggedIn') === 'true') {
                    adminLoginSuccess();
                }
            } else {
                console.error("Admin page not found!");
                showToast("Admin panel not found", "error");
                showPage('lobby');
            }
        }

        // Admin login
        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            const username = document.getElementById('adminUsername').value;
            
            // For testing: allow emergency access
            if (localStorage.getItem('adminEmergencyAccess') === 'true') {
                console.log("Emergency admin access granted");
                adminLoginSuccess();
                return;
            }
            
            // Normal admin check
            if (username === ADMIN_CONFIG.username && password === ADMIN_CONFIG.password) {
                localStorage.setItem('adminLoggedIn', 'true');
                localStorage.setItem('adminLoginTime', Date.now());
                adminLoginSuccess();
                showToast("Admin login successful!", "success");
            } else {
                showToast("Invalid credentials!", "error");
            }
        }

        // After successful login
        function adminLoginSuccess() {
            const loginForm = document.getElementById('adminLoginForm');
            const adminContent = document.getElementById('adminContent');
            
            if (loginForm) loginForm.style.display = 'none';
            if (adminContent) adminContent.style.display = 'block';
            
            // Load admin data
            loadAdminData();
            startAdminSessionTimer();
        }

        // Load admin data
        function loadAdminData() {
            console.log("Loading admin data...");
            
            try {
                // Load players
                const players = JSON.parse(localStorage.getItem('players') || '[]');
                document.getElementById('totalPlayers').textContent = players.length;
                
                // Load pending requests
                const pending = JSON.parse(localStorage.getItem('pendingDeposits') || '[]');
                document.getElementById('pendingCount').textContent = pending.length;
                
                // Calculate total deposits
                let totalDeposits = 0;
                players.forEach(player => {
                    totalDeposits += player.totalDeposited || 0;
                });
                document.getElementById('totalDepositsAmount').textContent = totalDeposits + ' ETB';
                
                // Calculate total winnings
                const games = JSON.parse(localStorage.getItem('gamesHistory') || '[]');
                let totalWinnings = 0;
                games.forEach(game => {
                    totalWinnings += game.prize || 0;
                });
                document.getElementById('totalWinningsAmount').textContent = totalWinnings + ' ETB';
                
                // Display pending requests
                displayPendingRequests();
                
                // Initialize search
                initializePlayerSearch();
                
            } catch (error) {
                console.error("Error loading admin data:", error);
                showToast("Error loading admin data", "error");
            }
        }

        // Display pending requests
        function displayPendingRequests() {
            const pendingList = document.getElementById('pendingList');
            const pending = JSON.parse(localStorage.getItem('pendingDeposits') || '[]');
            
            if (pending.length === 0) {
                pendingList.innerHTML = '<div class="empty-state">No pending requests</div>';
                return;
            }
            
            let html = '';
            pending.forEach((request, index) => {
                html += `
                    <div class="pending-item" style="background: white; border-radius: 8px; padding: 15px; margin-bottom: 10px; border-left: 4px solid #ff9800;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>${request.playerName || 'Unknown'}</strong><br>
                                <small>${request.phone}</small><br>
                                <span style="font-size: 1.2rem; color: #ff9800; font-weight: bold;">${request.amount} ETB</span>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn" style="background: #009b3a; color: white; padding: 8px 15px;" onclick="approveDeposit(${index})">‚úÖ Approve</button>
                                <button class="btn" style="background: #ef3340; color: white; padding: 8px 15px;" onclick="rejectDeposit(${index})">‚ùå Reject</button>
                            </div>
                        </div>
                        <small style="color: #666;">${new Date(request.timestamp).toLocaleString()}</small>
                    </div>
                `;
            });
            
            pendingList.innerHTML = html;
        }

        // Initialize player search
        function initializePlayerSearch() {
            const searchInput = document.getElementById('searchPlayer');
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    searchPlayers(this.value);
                });
            }
        }

        // Search players
        function searchPlayers(query) {
            const resultsDiv = document.getElementById('searchResults');
            const players = JSON.parse(localStorage.getItem('players') || '[]');
            
            if (!query.trim()) {
                resultsDiv.innerHTML = '<div class="empty-state">Start typing to search players...</div>';
                return;
            }
            
            const filtered = players.filter(player => 
                player.phone.includes(query) || 
                (player.name && player.name.toLowerCase().includes(query.toLowerCase()))
            );
            
            if (filtered.length === 0) {
                resultsDiv.innerHTML = '<div class="empty-state">No players found</div>';
                return;
            }
            
            let html = '';
            filtered.forEach(player => {
                html += `
                    <div class="player-result" onclick="selectPlayer('${player.phone}', '${player.name}')" 
                         style="padding: 10px; border-bottom: 1px solid #eee; cursor: pointer; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>${player.name || 'Unknown'}</strong><br>
                            <small>${player.phone}</small>
                        </div>
                        <div>
                            <span style="background: #009b3a; color: white; padding: 3px 10px; border-radius: 15px; font-size: 0.9rem;">
                                ${player.balance || 0} ETB
                            </span>
                        </div>
                    </div>
                `;
            });
            
            resultsDiv.innerHTML = html;
        }

        // Select player from search
        function selectPlayer(phone, name) {
            document.getElementById('adminPlayerPhone').value = phone;
            document.getElementById('adminPlayerName').value = name;
            showToast(`Selected ${name} (${phone})`, "info");
        }

        // Admin session timer
        function startAdminSessionTimer() {
            let minutes = 0;
            const timerElement = document.getElementById('adminSessionTime');
            
            const timer = setInterval(() => {
                minutes++;
                if (timerElement) {
                    timerElement.textContent = `${minutes}m`;
                }
                
                // Auto logout after timeout
                if (minutes >= ADMIN_CONFIG.sessionTimeout) {
                    clearInterval(timer);
                    adminLogout();
                    showToast("Session expired", "warning");
                }
            }, 60000);
        }

        // Admin logout
        function adminLogout() {
            localStorage.removeItem('adminLoggedIn');
            localStorage.removeItem('adminLoginTime');
            showToast("Logged out from admin", "info");
            showPage('lobby');
        }

        // Enable emergency admin access (for testing)
        function enableEmergencyAdminAccess() {
            localStorage.setItem('adminEmergencyAccess', 'true');
            initAdminAccess();
            showToast("Emergency admin access enabled", "warning");
        }

        // ==================== INITIALIZE ====================

        // Add this to your existing initialization
        document.addEventListener('DOMContentLoaded', function() {
            // Your existing lobby initialization...
            updateLobbyUI();
            
            // Initialize admin access
            initAdminAccess();
            
            // For testing: Add emergency access button
            setTimeout(() => {
                if (!isAdminUser() && window.location.hash === '#testadmin') {
                    enableEmergencyAdminAccess();
                }
            }, 1000);
            
            // Original admin.html script
            console.log('‚úÖ Admin Panel Loaded Successfully');
            
            // Update session timer every second
            let seconds = 0;
            setInterval(function() {
                seconds++;
                let hours = Math.floor(seconds / 3600);
                let minutes = Math.floor((seconds % 3600) / 60);
                let secs = seconds % 60;
                
                document.getElementById('sessionTimer').textContent = 
                    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }, 1000);
            
            // Add sample interactivity
            document.querySelectorAll('.btn').forEach(button => {
                button.addEventListener('click', function(e) {
                    if (!this.classList.contains('btn-primary')) return;
                    
                    const action = this.textContent.trim();
                    console.log(`Admin action: ${action}`);
                    
                    // Show toast notification
                    showToast(`Action executed: ${action}`, 'success');
                });
            });
            
            // Sample toast function
            function showToast(message, type) {
                const toast = document.createElement('div');
                toast.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: ${type === 'success' ? '#00c853' : '#ff5252'};
                    color: white;
                    padding: 15px 25px;
                    border-radius: 10px;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                    z-index: 9999;
                    animation: slideIn 0.3s ease;
                `;
                toast.textContent = message;
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    toast.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => toast.remove(), 300);
                }, 3000);
            }
            
            // Add CSS for animations
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
            
            // Make danger zone buttons show confirmation
            document.querySelectorAll('.danger-zone .btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    const action = this.textContent.replace(/[^a-zA-Z\s]/g, '').trim();
                    if (confirm(`‚ö†Ô∏è WARNING: Are you sure you want to ${action}?\n\nThis action cannot be undone!`)) {
                        showToast(`Executing: ${action}`, 'warning');
                    } else {
                        e.preventDefault();
                        showToast('Action cancelled', 'info');
                    }
                });
            });
            
            // Update pending badge
            function updatePendingBadge() {
                const badge = document.getElementById('pendingBadge');
                if (badge) {
                    badge.textContent = Math.floor(Math.random() * 5) + 1;
                }
            }
            
            // Update every 30 seconds
            setInterval(updatePendingBadge, 30000);
            updatePendingBadge();
        });

        // Add to your existing functions
        function selectRoom(price) {
            // This function would be in the main app
            console.log("Select room: " + price);
        }
    </script>
</body>
</html>
